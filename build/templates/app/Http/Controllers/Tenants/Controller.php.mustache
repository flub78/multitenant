{{=[[ ]]=}}
<?php

namespace App\Http\Controllers\Tenants;

use app\Http\Controllers\Controller;
use App\Models\User;
use App\Models\Tenants\Role;
use App\Models\Tenants\[[class_name]];
use Illuminate\Http\Request;
use Illuminate\Database\QueryException;


/**
 * Controller for [[element]]
 * 
 * 
 * @author frederic
 *
 */
class [[class_name]]Controller extends Controller
{
    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
    	$[[table]] = [[class_name]]::all();
    	return view ( 'tenants/[[element]]/index', compact ( '[[table]]' ) );
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
    	$user_list = User::selector();
    	$role_list = Role::selector();
    	return view ('tenants/[[element]]/create')
    		->with('role_list', $role_list)
    		->with('user_list', $user_list);   		;
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(Request $request)
    {
        $user_id = $request->user_id;
        $role_id = $request->role_id;
        try {
        	$id = [[class_name]]::create(['user_id' => $user_id, 'role_id' => $role_id]);
        	return redirect ( '/[[element]]' )->with ( 'success',  __('[[table]].created', ['user' => $id->user_name, 'role'=> $id->role_name]));
        } catch (QueryException $e) {
        	// very likely a duplicate
        	return redirect ( '/[[element]]' );
        }
    }

    /**
     * Display the specified resource.
     *
     * @param  \App\Models\Tenants\[[class_name]]  $[[element]]
     * @return \Illuminate\Http\Response

    public function show([[class_name]] $[[element]])
    {
        //
    }
     */
    
    /**
     * Show the form for editing the specified resource.
     *
     * @param  \App\Models\Tenants\[[class_name]]  $[[element]]
     * @return \Illuminate\Http\Response

    public function edit([[class_name]] $[[element]])
    {
        //
    }
     */
    
    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \App\Models\Tenants\[[class_name]]  $[[element]]
     * @return \Illuminate\Http\Response

    public function update(Request $request, [[class_name]] $[[element]])
    {
        //
    }
     */
    
    /**
     * Remove the specified resource from storage.
     *
     * @param  \App\Models\Tenants\[[class_name]]  $[[element]]
     * @return \Illuminate\Http\Response
     */
    public function destroy([[class_name]] $[[element]])
    {
    	$full_name = $[[element]]->full_name;
    	$[[element]]->delete();
    	return redirect ( '[[element]]' )->with ( 'success', __('general.deletion_success', ['elt' => $full_name]));
    }
}
